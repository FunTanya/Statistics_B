---
title: 'Chapter 1: Tables'
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Employees of a Small Business Company: Using Simple Commnads
- reading data:
```{r}
EX_DATA_DF <- readRDS("../data/EX_DATA_DF.rds")
```
- frequency distribution for Degree
```{r }
fi = table(EX_DATA_DF$Degree)
print(fi)
```
- percent
```{r}
(percent = prop.table(table(EX_DATA_DF$Degree))*100)
```
- cumulative frequency
```{r}
(cum.fi = cumsum(table(EX_DATA_DF$Degree)))
```
- cumulative percent
```{r}
(cum.percent = cumsum(prop.table(table(EX_DATA_DF$Degree)))*100)
```
- all together
```{r}
cbind(fi,percent,cum.fi,cum.percent)
```
- contingency table with row and column totals
```{r}
addmargins(table(EX_DATA_DF$Gender,EX_DATA_DF$Degree))
```

# Employees of a Small Business Company: Using Tidyverse and pander packages
- frequency distribution for Degree with \texttt{tidyverse}
```{r warning=FALSE, message=FALSE}
library(tidyverse)
EX_DATA_DF %>% select(Degree) %>%
    table()
```  
- frequency distribution for Degree: (simple) tables with pander
```{r warning=FALSE, message=FALSE, results='asis'}
library(pander)
EX_DATA_DF %>% select(Degree) %>%
    table() %>% 
    pander()
```  

- percent
```{r}
EX_DATA_DF %>% select(Degree) %>%
  table() %>%
  prop.table()  %>% 
  "*"(100) %>% 
   pander()
```
- cumulative frequency
```{r}
EX_DATA_DF %>% select(Degree) %>%
  table() %>%
  cumsum( ) %>% 
  pander()
```
- cumulative percent
```{r}
EX_DATA_DF %>% select(Degree) %>%
  table() %>%
  prop.table() %>% 
  cumsum() %>% 
  "*"(100) %>% 
  pander()
```
- all together
```{r}
EX_DATA_DF %>%
  group_by(Degree) %>% 
  summarize(fi=n()) %>% 
  mutate(percent = round(prop.table(fi)*100,2))%>% 
  mutate(cum.fi = cumsum(fi)) %>% 
  mutate(cum.percent = cumsum(percent)) %>% 
  pander()
```

- contingency table with row and column totals (a)
```{r}
EX_DATA_DF %>% select(Gender,Degree) %>%
  table() %>%
  addmargins() %>% 
  pander()
```

- contingency table with row and column totals (b)
```{r warning=FALSE, message=FALSE, results="asis"}
library(pander)
library(janitor)
EX_DATA_DF %>% 
  group_by(Gender,Degree) %>% 
  summarise(fij=n(), .groups = 'drop') %>% 
  spread(Degree,fij) %>% 
  adorn_totals(name = 'col.sum') %>% 
  adorn_totals(name = 'row.sum', where = 'col') %>% 
  pander()
```